{% extends "base.html" %}
{% block content %}
    <h2>Search</h2>
    <form action="{% url 'search:search' %}">
        <input type="search" name="q" value="{{search.query}}">
        <input type="submit"><input type="reset">
    {% if search.facets and search.total > 1 %}
    <nav>
        <h3>Filters</h3>
        <ul>{% for name, info in search.facets.items %}{% if info %}
            <li>
                <h4>{{ name|title }}</h4>
                <ol>{% for label, count, selected in info  %}
                    <li>{% spaceless %}
                        <label>
                            <input type="checkbox" name="facet" {% if selected %}checked{% endif %}
                                value="{{name}}:{{label}}">{{label|title}} ({{count}})
                        </label>{% endspaceless %}
                    </li>{% endfor %}
                </ol>
            </li>{% endif %}
            {% empty %}
            <li>No filters available</li>
            {% endfor %}
        </ul>
    </nav>
    {% endif %}
    </form>
    <p>Results {{search.offset|add:'1'}}&ndash;{{search.offset|add:search.size}} of {{search.total}}</p>
    <ol start="{{search.offset|add:'1'}}">{% for result in search.response %}
        <li>
            <section>
                <h2><a href="{{ result.url }}">{{ result.get_display_name }}</a></h2>
                <h3>{{ result.get_model_meta.model }}</h3>
                {% for field,value_list in result.meta.highlight.to_dict.items  %}
                <h4>{{field}}</h4>
                {% for item in value_list  %}
                <p>{{item|safe}}</p>{% endfor %}
                {% endfor %}
            </section>
        </li>{% endfor %}
    </ol>
{% endblock %}
