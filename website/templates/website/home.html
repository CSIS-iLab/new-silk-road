{% extends 'base.html' %}{% load static %}

{% block bodyclass %}home{% endblock %}

{% block content-shell %}
<section id='map' class='poster'>
    <a href="{% url 'website-map' %}">
        <div class="inner">
                <h2>Explore</h2>
                <h3>The Map</h3>
                <img src='{% static "img/white_arrow.svg" %}' alt="Arrow button" />
        </div>
    </a>
</section>
<section id='featured-articles'>
    <header>
        <h2>Articles</h2>
    </header>
    {% for entry, truncate_length in featured_entry_set %}
        <div class="featured-entry entry-{{ forloop.counter }}{% if entry.entry.is_sponsored %} sponsored-entry{% endif %}">
            <a href="{{ entry.entry.get_absolute_url }}"><h3 class="entry-title">{{ entry.entry.title }}</h3></a>
            <div class="entry-byline">
                <span class="entry-date">{{ entry.entry.publication_date.date }}</span>
                <span class="entry-author">{{ entry.entry.author }}</span>
            </div>
            {% if entry.entry.is_sponsored %}<img class="sponsored-logo" src="{{ entry.entry.sponsored_logo.url }}">{% endif %}
            <a href="{{ entry.entry.get_absolute_url }}"><img class="featured-image" src="{{ entry.entry.featured_image.url }}"></a>
            <div class="entry-preview">{{ entry.entry.content_rendered | safe | truncatewords_html:truncate_length }}</div>
        </div>
    {% endfor %}
</section>
<section id='db-search'>
    <h2>Search the Database</h2>
    <p>Search hundreds of projects and the people, organizations, and events behind them.</p>
    <section role="search">
        {% include "search/_search_form.html" %}
    </section>
</section>
<section id='db-summary'>
    <div class="wrap">
        <div class="count">
            <span class="value">{{ db_totals.road.count }}</span>
            <span class="label">Roads</span>
        </div>
        <div class="count">
            <span class="">{{ db_totals.rail.count }}</span>
            <span class="label">Railroads</span>
        </div>
        <div class="count">
            <span class="">{{ db_totals.seaport.count }}</span>
            <span class="label">Seaports</span>
        </div>
        <div class="count">
            <span class="">{{ db_totals.intermodal.count }}</span>
            <span class="label">Dryports</span>
        </div>
    </div>
</section>
<section id='visions' class="buzz">
{% include "writings/_special_analyses.html" %}
</section>
<section id="fantasy" class='feature columnar'>
    <h2>From the Field</h2>
    <div class="wrap">
        <div class="poster">
            <figure>
                <img src="{% static 'img/homepage/Khorgos_photo.jpg' %}" alt="Photo of a dry port in Khorgos" />
                <figcaption>Khorgos Dry Port by David Parker</figcaption>
            </figure>
        </div>
        <div class="poster">
            <figure>
                <img src="{% static 'img/homepage/Gwadar_port.jpg' %}" alt="Photo of Gwadar Port" />
                <figcaption>Gwadar Port by Umargondal</figcaption>
            </figure>
        </div>
        <div class="callout">
            <p>
                <a class="button gem" href="{% url 'contribute' %}">Submit Content</a>
            </p>
        </div>
    </div>
</section>
{% endblock content-shell %}


{% block extrahead %}
<link rel="stylesheet" href="{% static 'css/lib/magnific-popup.css' %}">
<script src="{% static 'js/lib/jquery.magnific-popup.min.js' %}"></script>
{% endblock %}


{% block postbodyjs %}
<script type="text/javascript">
    Zepto(function($){
        $('#video a.play').magnificPopup({
            type:'iframe',
            iframe: {
                patterns: {
                    vimeo: {
                        index: 'vimeo.com/',
                        id: '/',
                        src: '//player.vimeo.com/video/%id%?color=abd58c&autoplay=1'
                    }
                }
            }
        });
    });
</script>
{% endblock %}
